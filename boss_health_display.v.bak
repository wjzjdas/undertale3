module boss_health_display(
    input CLOCK_50,
    input resetn,
    input enable,
    input you_lose,
    output reg [7:0] VGA_X,
    output reg [6:0] VGA_Y,
    output reg [2:0] color_to_display,
    output reg plot
);
    // Boss 血条的初始长度
    reg [5:0] boss_health;
    reg [31:0] health_timer;

    initial begin
        boss_health = 6'd60;  // 初始血条长度为 60
        health_timer = 32'd0;
    end

    // 计时器，每秒减少一次血条长度
    always @(posedge CLOCK_50 or negedge resetn) begin
        if (!resetn) begin
            boss_health <= 6'd60;
            health_timer <= 32'd0;
        end else if (enable && !you_lose && boss_health > 0) begin
            if (health_timer >= 32'd50_000_000) begin  // 每经过大约 1 秒减少一次血条
                health_timer <= 32'd0;
                boss_health <= boss_health - 1;
            end else begin
                health_timer <= health_timer + 1;
            end
        end
    end

    // 绘制血条
    always @(posedge CLOCK_50 or negedge resetn) begin
        if (!resetn) begin
            VGA_X <= 8'd0;
            VGA_Y <= 7'd0;
            color_to_display <= 3'b000;
            plot <= 1'b0;
        end else if (enable) begin
            if (VGA_Y == 7'd109 && VGA_X >= 8'd55 && VGA_X < (8'd55 + boss_health)) begin
                color_to_display <= 3'b100;  // 红色血条
                plot <= 1'b1;
            end else begin
                plot <= 1'b0;
            end
        end else begin
            plot <= 1'b0;
        end
    end
endmodule
